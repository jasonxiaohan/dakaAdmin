/** layuiAdmin.pro-v1.2.1 LPPL License By http://www.layui.com/admin/ */
 ;layui.define(["table","form","util"],function(e){var t=(layui.$,layui.admin),i=layui.view,l=layui.setter,r=layui.table,a=layui.util,n=layui.form;r.render({elem:"#LAY-user-manage",url:"./json/useradmin/webuser.js",cols:[[{type:"checkbox",fixed:"left"},{field:"id",width:100,title:"ID",sort:!0},{field:"username",title:"用户名",minWidth:100},{field:"avatar",title:"头像",width:100,templet:"#imgTpl"},{field:"phone",title:"手机"},{field:"email",title:"邮箱"},{field:"sex",width:80,title:"性别"},{field:"ip",title:"IP"},{field:"jointime",title:"加入时间",sort:!0},{title:"操作",width:150,align:"center",fixed:"right",toolbar:"#table-useradmin-webuser"}]],page:!0,limit:30,height:"full-320",text:{none:"暂无数据"}}),r.on("tool(LAY-user-manage)",function(e){var l=e.data;"del"===e.event?layer.prompt({formType:1,title:"敏感操作，请验证口令"},function(t,i){layer.close(i),layer.confirm("真的删除行么",function(t){e.del(),layer.close(t)})}):"edit"===e.event&&t.popup({title:"编辑用户",area:["500px","450px"],id:"LAY-popup-user-add",success:function(e,t){i(this.id).render("user/user/userform",l).done(function(){n.render(null,"layuiadmin-form-useradmin"),n.on("submit(LAY-user-front-submit)",function(e){e.field;layui.table.reload("LAY-user-manage"),layer.close(t)})})}})}),r.render({elem:"#LAY-user-back-manage",url:l.remoteurl+"/systemadmin/userlist",where:{access_token:layui.data(l.tableName).access_token},cols:[[{type:"checkbox",fixed:"left"},{field:"adminId",width:80,title:"ID",sort:!1},{field:"username",title:"登录名"},{field:"cellphone",title:"手机"},{field:"email",title:"邮箱"},{field:"roleName",title:"角色"},{field:"address",title:"地址"},{field:"createTime",title:"创建时间",templet:function(e){return a.toDateString(e.createTime,"yyyy-MM-dd HH:mm:ss")}},{field:"isDel",title:"审核状态",templet:"#buttonTpl",minWidth:80,align:"center"},{title:"操作",width:150,align:"center",fixed:"right",toolbar:"#table-useradmin-admin"}]],done:function(e,t,i){},text:{none:"暂无数据"}}),r.on("tool(LAY-user-back-manage)",function(e){var r=e.data;"del"===e.event?layer.prompt({formType:1,title:"敏感操作，请验证口令"},function(i,a){layer.close(a),layer.confirm("确定删除此管理员？",function(i){t.req({url:l.remoteurl+"/systemadmin/users",method:"DELETE",data:{adminId:r.adminId},success:function(e){0==e.code?layer.msg("删除成功",{time:1e3,icon:1},function(){var e=parent.layer.getFrameIndex(window.name);parent.layer.close(e),window.parent.location.reload()}):layer.msg(e.msg,{icon:5})}}),e.del(),layer.close(i)})}):"edit"===e.event&&t.popup({title:"编辑管理员",area:["420px","450px"],id:"LAY-popup-user-add",success:function(e,a){i(this.id).render("user/administrators/adminform",r).done(function(){n.render(null,"layuiadmin-form-admin"),n.on("submit(LAY-user-back-submit)",function(e){var i=e.field;t.req({url:l.remoteurl+"/systemadmin/users",method:"PUT",data:i,success:function(e){0==e.code?layer.msg("修改成功",{time:1e3,icon:1},function(){var e=parent.layer.getFrameIndex(window.name);parent.layer.close(e),window.parent.location.reload()}):layer.msg(e.msg,{icon:5})}}),layui.table.reload("LAY-user-back-manage"),layer.close(a)})})}})}),r.render({elem:"#LAY-user-back-role",url:l.remoteurl+"/systemrole/roles",where:{access_token:layui.data(l.tableName).access_token},cols:[[{type:"checkbox",fixed:"left"},{field:"roleId",width:80,title:"ID",sort:!0},{field:"roleName",title:"角色名"},{field:"rights",title:"拥有权限"},{field:"descr",title:"具体描述"},{title:"操作",width:150,align:"center",fixed:"right",toolbar:"#table-useradmin-admin"}]],text:{none:"暂无数据"}}),r.on("tool(LAY-user-back-role)",function(e){var r=e.data;"del"===e.event?layer.confirm("确定删除此角色？",function(i){t.req({url:l.remoteurl+"/systemrole/roles",method:"DELETE",data:{roleId:e.data.roleId},success:function(e){0==e.code?layer.msg("删除成功",{time:1e3,icon:1},function(){var e=parent.layer.getFrameIndex(window.name);parent.layer.close(e),window.parent.location.reload()}):layer.msg(e.msg,{icon:5})}}),e.del(),layer.close(i)}):"edit"===e.event?t.popup({title:"修改新角色",area:["500px","480px"],id:"LAY-popup-user-add",success:function(e,a){i(this.id).render("user/administrators/roleform",r).done(function(){n.render(null,"layuiadmin-form-role"),n.on("submit(LAY-user-role-submit)",function(e){var i=e.field;t.req({url:l.remoteurl+"/systemrole/roles",method:"PUT",data:i,success:function(e){0==e.code?layer.msg("修改成功",{time:1e3,icon:1},function(){var e=parent.layer.getFrameIndex(window.name);parent.layer.close(e),window.parent.location.reload()}):layer.msg(e.msg,{icon:5})}}),layui.table.reload("LAY-user-back-role"),layer.close(a)})})}}):t.req({url:l.remoteurl+"/systemrole/roles",method:"POST",data:e.field,success:function(e){0==e.code?layer.msg("添加成功",{time:1e3,icon:1},function(){var e=parent.layer.getFrameIndex(window.name);parent.layer.close(e),window.parent.location.reload()}):layer.msg(e.msg,{icon:5})}})}),e("useradmin",{})});